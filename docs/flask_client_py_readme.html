---

title: Flask app from smart-on-fhir/client-py/README.md


keywords: fastai
sidebar: home_sidebar

summary: "Getting started with Flask using client-py."
description: "Getting started with Flask using client-py."
nb_path: "51_flask_client_py_readme.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 51_flask_client_py_readme.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://colab.research.google.com/github/pete88b/smart-on-fhir-client-py-demo/blob/main/51_flask_client_py_readme.ipynb"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"></a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Getting-started">Getting started<a class="anchor-link" href="#Getting-started"> </a></h1><p>You can run this notebook</p>
<ul>
<li><a href="https://colab.research.google.com/github/pete88b/smart-on-fhir-client-py-demo/blob/main/51_flask_client_py_readme.ipynb">in colab</a> or<ul>
<li>Feel free to ignore the "Start the app", "Convert this notebook" and "Run the app locally" sections</li>
</ul>
</li>
<li>on your own machine<ul>
<li>Please see index.ipynb and set things up to run on your own machine.</li>
</ul>
</li>
</ul>
<p>See also: <a href="https://github.com/smart-on-fhir/client-py">https://github.com/smart-on-fhir/client-py</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Code-and-test-a-simple-flask-app">Code and test a simple flask app<a class="anchor-link" href="#Code-and-test-a-simple-flask-app"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="App-setup">App setup<a class="anchor-link" href="#App-setup"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Helper-functions">Helper functions<a class="anchor-link" href="#Helper-functions"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">smart</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">FHIRClient</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="n">smart_defaults</span><span class="p">)</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">_get_patients</span><span class="p">(</span><span class="n">smart</span><span class="p">):</span> <span class="k">assert</span> <span class="n">p</span><span class="o">.</span><span class="n">id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="c1"># TODO: write a better test</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Views">Views<a class="anchor-link" href="#Views"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="index" class="doc_header"><code>index</code><a href="https://github.com/pete88b/smart_on_fhir_client_py_demo/tree/main/smart_on_fhir_client_py_demo/flask_client_py_readme.py#L86" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>index</code>()</p>
</blockquote>
<p>The app's main page.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="callback" class="doc_header"><code>callback</code><a href="https://github.com/pete88b/smart_on_fhir_client_py_demo/tree/main/smart_on_fhir_client_py_demo/flask_client_py_readme.py#L133" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>callback</code>()</p>
</blockquote>
<p>OAuth2 callback interception.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="logout" class="doc_header"><code>logout</code><a href="https://github.com/pete88b/smart_on_fhir_client_py_demo/tree/main/smart_on_fhir_client_py_demo/flask_client_py_readme.py#L145" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>logout</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="reset" class="doc_header"><code>reset</code><a href="https://github.com/pete88b/smart_on_fhir_client_py_demo/tree/main/smart_on_fhir_client_py_demo/flask_client_py_readme.py#L151" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>reset</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Start-the-app">Start the app<a class="anchor-link" href="#Start-the-app"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Convert-this-notebook-to-a-python-module">Convert this notebook to a python module<a class="anchor-link" href="#Convert-this-notebook-to-a-python-module"> </a></h2><p>After making changes to this notebook, we need to get nbdev to re-create the <code>flask_client_py_readme.py</code> file.</p>
<p>We can do this in code &darr; or from the command line with <code>nbdev_build_lib</code></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="ow">not</span> <span class="n">IN_COLAB</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">nbdev.export</span> <span class="kn">import</span> <span class="n">notebook2script</span>
    <span class="n">notebook2script</span><span class="p">(</span><span class="s1">&#39;51_flask_client_py_readme.ipynb&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Converted 51_flask_client_py_readme.ipynb.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Run-the-app-locally">Run the app locally<a class="anchor-link" href="#Run-the-app-locally"> </a></h2><p>Now we can run <code>python smart_on_fhir_client_py_demo/flask_client_py_readme.py</code> from the command line and hit</p>
<ul>
<li><a href="http://localhost:8000/">http://localhost:8000/</a></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Run-the-app-in-colab">Run the app in colab<a class="anchor-link" href="#Run-the-app-in-colab"> </a></h2><p>The following cell will only run if you're in colab, where you'll see output like</p>

<pre><code> * Serving Flask app "__main__" (lazy loading)
 ...
INFO:werkzeug: * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): bin.equinox.io:443
...
DEBUG:urllib3.connectionpool:http://localhost:4040 "GET /api/tunnels HTTP/1.1" 200 779
 * Running on http://35c09c8e5eb5.ngrok.io
 * Traffic stats available on http://127.0.0.1:4040</code></pre>
<p>Hit the <code>ngrok.io</code> link to see the app - none of the localhost or 127.0.0.1 links will work</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">IN_COLAB</span><span class="p">:</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>
    <span class="kn">from</span> <span class="nn">flask_ngrok</span> <span class="kn">import</span> <span class="n">run_with_ngrok</span>
    <span class="n">run_with_ngrok</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

